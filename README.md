# github-release-pr

A simple script to open a release pull-request with a message using merged logs.

## Basic usage

```
$ cd path/to/github-repository
$ github-release-pr
```

Confirm the release PR message generated by script using differences between `master` and `develop` branches.

```
[Release] 2017-02-11 14:29

* [sample branch 1](1) *( __feature/sample-branch1__ by __foobar__ )*
* [sample branch 2](2) *( __feature/sample-branch2__ by __foobar__ )*
---
Create this release pull-request? [Y/n]:
```

A release pull request will be created.

## Options

| Option     | Description                                                  |
| ---------- | ------------------------------------------------------------ |
| c filename | Specify the custom config script                             |
| e          | Edit generated message                                       |
| f          | Create PR without message confirmation                       |
| o          | The created PR will open in the web browser                  |

## Dependency

You need to install [hub](https://hub.github.com/) command to use this script.

## Configuration

A custom configuration script can be specified.

Put `release-pr.sh` script onto `.github` directory under the github repository.

```
path/to/github-repository/.github/release-pr.sh
```

Or specify the config script file by option `c` .

### Creating your message generating method

Create the custom function to generate the new message file names `$_GHRPR_TEMPLATE`. You can use the variables below.

| Variables                  | Description                                                                 |
| -------------------------- | --------------------------------------------------------------------------- |
| $_GHRPR_TEMPLATE           | Text file to put new message                                                |
| $_GHRPR_REPOSITORY_NAME    | Git repository name                                                         |
| $_GHRPR_MERGES_TITLE[]     | Merges title                                                                |
| $_GHRPR_MERGES_PR_ID[]     | Merges ID                                                                   |
| $_GHRPR_MERGES_BRANCH[]    | Merges branch name                                                          |
| $_GHRPR_MERGES_COMMIT[]    | Merges commit ID                                                            |
| $_GHRPR_MERGES_AUTHOR[]    | Merges author name                                                          |
| $_GHRPR_MERGES_COMMITTER[] | Merges committer name                                                       |

Sample file:

```
function create_template {
  echo "RELEASE" >> $_GHRPR_TEMPLATE
  echo "" >> $_GHRPR_TEMPLATE
  echo "Check the releasing PRs(${#_GHRPR_MERGES_TITLE[@]})" >> $_GHRPR_TEMPLATE
  echo "" >> $_GHRPR_TEMPLATE
  local inx=0
  for title in "${_GHRPR_MERGES_TITLE[@]}"
  do
    echo "- [ ] [$title](${_GHRPR_MERGES_PR_ID[$inx]})" >> $_GHRPR_TEMPLATE
    inx=$(($inx+1))
  done
}
```

Output:

```
RELEASE

Check the releasing PRs(3)

- [ ] [sample branch 1](1)
- [ ] [sample branch 2](2)
- [ ] [sample branch 3](3)
```

### Specify the releasing branch

```
export GHRPR_DEVELOP_BRANCH=develop
export GHRPR_RELEASE_BRANCH=master
```

### Specify the editor to edit the new message


```
export GHRPR_EDITOR=vim
```
